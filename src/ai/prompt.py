# Исправленный шаблон сопроводительного письма
# letter_template = (
#     'Добрый день!\n'
#     '\n'
#     'Меня зовут {candidate_name}.\n'
#     '\n'
#     'Я с большим интересом ознакомил{gender_ending} с вашей вакансией на должность {position}. '
#     'Ваше описание позиции и перечень задач говорят о том, что передо мной стоят масштабные и '
#     'интересные проекты, которые полностью соответствуют моим профессиональным интересам и '
#     'областям экспертизы:\n'
#     '\n'
#     '{relevant_skills_match}\n'
#     '\n'
#     '▸ Мой опыт в области {key_expertise} идеально подходит для решения поставленных задач.\n'
#     '\n'
#     'Кратко о себе:\n'
#     '{personal_highlights}\n'
#     '\n'
#     'Я уверен{gender_ending}, что мой опыт и навыки позволят мне внести значительный вклад в '
#     'успех вашей компании. Я готов{gender_ending} применить свои знания для решения интересных '
#     'и сложных задач, стоящих перед вашей командой.\n'
#     '\n'
#     'Зарплатные ожидания {salary}\n'
#     '\n'
#     'С нетерпением жду возможности обсудить, как я могу помочь вашей команде достигнуть её целей. '
#     'Связаться со мной можно по электронной почте{contact_methods}:\n'
#     '{contact_info}\n'
#     '\n'
#     'Благодарю за внимание и надеюсь на скорую встречу!\n'
#     '\n'
#     'С уважением,\n'
#     '{candidate_name}'
# )

letter_template = (
    'Добрый день!\n'
    '\n'
    'Меня зовут {candidate_name}. Меня заинтересовала вакансия {position}: указанные задачи соответствуют моему опыту и навыкам.\n'
    '\n'
    '{relevant_skills_match}\n'
    '\n'
    '▸ У меня большой опыт в области {key_expertise}, который пригодится на этой позиции.\n'
    '\n'
    'Немного о себе:\n'
    '{personal_highlights}\n'
    '\n'
    'Уверен{gender_ending}, что мой опыт будет полезен вашей компании. Готов{gender_ending} применить свои навыки для решения задач вашей команды.\n'
    '\n'
    'Мои ожидания по зарплате — {salary}.\n'
    '\n'
    'Буду рад{gender_ending} обсудить, как могу помочь вашей команде достигнуть целей. Связаться со мной можно по электронной почте{contact_methods}:\n'
    '{contact_info}\n'
    '\n'
    'Спасибо зa внимание и надеюсь na скорую встречу!\n'
    '\n'
    'С уважением,\n'
    '{candidate_name}'
)

# Улучшенный system prompt
system_prompt = """Ты эксперт по составлению персонализированных сопроводительных писем. 

Твоя задача:
1. Проанализировать резюме кандидата и описание вакансии
2. Заменить все плейсхолдеры в шаблоне письма на релевантный контент
3. Создать убедительное письмо, подчеркивающее соответствие кандидата позиции

Правила заполнения плейсхолдеров:
- {{candidate_name}}: Имя и фамилия без отчества из резюме
- {{gender_ending}}: "а" для женщин, "" для мужчин (определи по имени)
- {{position}}: Название должности из описания вакансии
- {{relevant_skills_match}}: 2-3 конкретных навыка/опыта из резюме, которые точно соответствуют требованиям вакансии
- {{key_expertise}}: Ключевая область экспертизы кандидата, наиболее релевантная для позиции
- {{personal_highlights}}: 3-4 пункта о достижениях и опыте кандидата в формате "● Текст"
- {{contact_methods}}: Дополнительные способы связи если есть (например, " или через Telegram")
- {{contact_info}}: Контактная информация в формате "➜ email" и "➜ другие контакты"
- {{salary}}: Сумма зарплаты указанная в вакансии. Если в вакансии зарплата не указана, то точную сумму из резюме. Не используй разделители между цифрами. Название валюты укажи на русском языке

Шаблон письма:
{letter_template}

Резюме кандидата:
{resume}

Описание вакансии:
{job_description}
"""

# Упрощенный user prompt
user_prompt = """Сгенерируй персонализированное сопроводительное письмо на основе предоставленных данных. 

Выведи только готовый текст письма без дополнительных комментариев."""


def generate_system_prompt(resume_text, job_description_text):
    """
    Генерирует системный промпт на основе резюме и описания вакансии

    Args:
        resume_text (str): Текст резюме кандидата
        job_description_text (str): Описание вакансии

    Returns:
        tuple: (system_prompt) готовый для отправки в LLM
    """
    # Форматируем system prompt с данными
    formatted_system_prompt = system_prompt.format(
        letter_template=letter_template,
        resume=resume_text,
        job_description=job_description_text
    )

    return formatted_system_prompt